<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <base target="_self">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Núcleo de Missões</title>
    <meta name="description" content="App de missões diárias com sistema de recompensas">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#0f172a",
                        secondary: "#1e293b",
                        accent: "#6366f1",
                        success: "#22c55e",
                        warning: "#f59e0b"
                    },
                    fontFamily: {
                        'tech': ['Orbitron', 'monospace']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap');
        
        .glow-text {
            text-shadow: 0 0 10px #6366f1, 0 0 20px #6366f1, 0 0 30px #6366f1;
        }
        
        .tech-border {
            border: 2px solid #6366f1;
            box-shadow: 0 0 10px #6366f1;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
        }
        
        .futuristic-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e1e2e 100%);
        }
    </style>
</head>
<body class="min-h-screen futuristic-bg text-white font-tech">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 flex items-center justify-center futuristic-bg z-50">
        <div class="text-center">
            <div class="w-20 h-20 mx-auto mb-6 tech-border rounded-full flex items-center justify-center">
                <div class="w-16 h-16 border-4 border-accent rounded-full animate-spin"></div>
            </div>
            <h1 class="text-3xl font-bold glow-text mb-4">NÚCLEO DE MISSÕES</h1>
            <p class="text-gray-400">Inicializando sistema...</p>
            <div class="w-64 h-2 bg-gray-700 rounded-full mt-6 mx-auto">
                <div class="h-full progress-bar rounded-full animate-pulse"></div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="bg-primary tech-border-b p-4">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-2xl font-bold glow-text">NÚCLEO DE MISSÕES</h1>
                <div class="flex items-center space-x-4">
                    <div class="text-sm">
                        <span class="text-accent">Nível</span>
                        <span id="userLevel" class="ml-2">1</span>
                    </div>
                    <div class="text-sm">
                        <span class="text-accent">Pontos</span>
                        <span id="userPoints" class="ml-2">0</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-secondary tech-border-b">
            <div class="container mx-auto">
                <div class="flex overflow-x-auto">
                    <button class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent hover:border-accent" data-tab="missions">
                        MISSÕES
                    </button>
                    <button class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent hover:border-accent" data-tab="shop">
                        LOJA
                    </button>
                    <button class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent hover:border-accent" data-tab="notes">
                        ANOTAÇÕES
                    </button>
                    <button class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent hover:border-accent" data-tab="stats">
                        STATUS
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="container mx-auto p-4">
            <!-- Missions Tab -->
            <div id="missionsTab" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="tech-border p-4 rounded-lg">
                        <h2 class="text-lg font-bold text-accent mb-4">MISSÕES DIÁRIAS</h2>
                        <div id="missionsList" class="space-y-3">
                            <!-- Missions will be populated here -->
                        </div>
                    </div>
                    
                    <div class="tech-border p-4 rounded-lg">
                        <h2 class="text-lg font-bold text-accent mb-4">PROGRESSO DIÁRIO</h2>
                        <div class="text-center mb-4">
                            <div class="text-3xl font-bold glow-text" id="dailyProgress">0%</div>
                            <div class="text-sm text-gray-400">Conclusão</div>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2 mb-6">
                            <div class="h-full progress-bar rounded-full" id="progressBar" style="width: 0%"></div>
                        </div>
                        
                        <h3 class="text-md font-bold text-accent mb-3">PRÓXIMO NÍVEL</h3>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div class="h-full bg-accent rounded-full" id="xpBar" style="width: 0%"></div>
                        </div>
                        <div class="text-sm text-gray-400 mt-2 text-center" id="xpText">XP: 0/100</div>
                    </div>
                </div>
            </div>

            <!-- Shop Tab -->
            <div id="shopTab" class="tab-content hidden">
                <div class="tech-border p-4 rounded-lg">
                    <h2 class="text-lg font-bold text-accent mb-4">LOJA DE RECOMPENSAS</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="shopItems">
                        <!-- Shop items will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Notes Tab -->
            <div id="notesTab" class="tab-content hidden">
                <div class="tech-border p-4 rounded-lg">
                    <h2 class="text-lg font-bold text-accent mb-4">ANOTAÇÕES</h2>
                    <textarea 
                        id="notesTextarea" 
                        class="w-full h-64 bg-gray-800 border border-gray-600 text-white p-4 rounded-lg focus:outline-none focus:border-accent"
                        placeholder="Anote seu progresso aqui..."
                    ></textarea>
                    <button id="saveNotes" class="mt-4 bg-accent hover:bg-indigo-700 text-white px-6 py-2 rounded-lg">
                        SALVAR ANOTAÇÕES
                    </button>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="statsTab" class="tab-content hidden">
                <div class="tech-border p-4 rounded-lg">
                    <h2 class="text-lg font-bold text-accent mb-4">ESTATÍSTICAS</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center p-4 tech-border rounded-lg">
                            <div class="text-3xl font-bold glow-text" id="totalMissions">0</div>
                            <div class="text-sm text-gray-400">Missões Concluídas</div>
                        </div>
                        <div class="text-center p-4 tech-border rounded-lg">
                            <div class="text-3xl font-bold glow-text" id="totalPoints">0</div>
                            <div class="text-sm text-gray-400">Pontos Ganhos</div>
                        </div>
                        <div class="text-center p-4 tech-border rounded-lg">
                            <div class="text-3xl font-bold glow-text" id="daysActive">1</div>
                            <div class="text-sm text-gray-400">Dias Ativos</div>
                        </div>
                        <div class="text-center p-4 tech-border rounded-lg">
                            <div class="text-3xl font-bold glow-text" id="itemsBought">0</div>
                            <div class="text-sm text-gray-400">Itens Comprados</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-primary tech-border-t p-4 mt-8">
            <div class="container mx-auto text-center text-sm text-gray-400">
                <p>Desenvolvido por <span class="text-accent">Tio-LP</span></p>
                <p class="mt-1">© 2024 Núcleo de Missões - Todos os direitos reservados</p>
            </div>
        </footer>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="tech-border bg-primary p-6 rounded-lg mx-4 max-w-md">
            <h3 class="text-lg font-bold text-accent mb-4" id="modalTitle">Confirmar Ação</h3>
            <p class="text-gray-300 mb-6" id="modalMessage">Tem certeza que deseja realizar esta ação?</p>
            <div class="flex justify-end space-x-4">
                <button id="modalCancel" class="px-4 py-2 border border-gray-600 text-gray-300 rounded-lg">Cancelar</button>
                <button id="modalConfirm" class="px-4 py-2 bg-accent text-white rounded-lg">Confirmar</button>
            </div>
        </div>
    </div>

    <script>
        // App Data Structure
        const appData = {
            user: {
                level: 1,
                xp: 0,
                points: 0,
                totalMissions: 0,
                daysActive: 1,
                itemsBought: 0
            },
            missions: [
                { id: 1, name: "Acordar cedo", completed: false, points: 10, xp: 15 },
                { id: 2, name: "Tomar café com Deus", completed: false, points: 15, xp: 20 },
                { id: 3, name: "Lavar os pratos", completed: false, points: 5, xp: 10 },
                { id: 4, name: "Beber água", completed: false, points: 3, xp: 5 },
                { id: 5, name: "Trabalhar na addon", completed: false, points: 20, xp: 25 },
                { id: 6, name: "Cuidar da esposa", completed: false, points: 15, xp: 20 },
                { id: 7, name: "Ler a palavra", completed: false, points: 15, xp: 20 },
                { id: 8, name: "Falar com Deus", completed: false, points: 10, xp: 15 },
                { id: 9, name: "Dormir cedo", completed: false, points: 10, xp: 15 },
                { id: 10, name: "Anotar progresso", completed: false, points: 5, xp: 10 }
            ],
            shopItems: [
                { id: 1, name: "Jogar 30 minutos", cost: 20, description: "30 minutos de tempo de jogo" },
                { id: 2, name: "Assistir 1 HR", cost: 40, description: "1 hora de conteúdo audiovisual" },
                { id: 3, name: "Ver shorts 10 minutos", cost: 15, description: "10 minutos de shorts" }
            ],
            notes: "",
            lastReset: new Date().toDateString()
        };

        // XP requirements for levels
        const xpRequirements = [0, 100, 250, 500, 1000, 2000, 4000, 8000, 16000, 32000];

        // Initialize the app
        function initApp() {
            loadFromStorage();
            checkDailyReset();
            renderMissions();
            renderShop();
            updateUI();
            
            // Hide loading screen after 2 seconds
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
            }, 2000);
        }

        // Load data from localStorage
        function loadFromStorage() {
            const savedData = localStorage.getItem('nucleoMissoesData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(appData, parsedData);
            }
        }

        // Save data to localStorage
        function saveToStorage() {
            localStorage.setItem('nucleoMissoesData', JSON.stringify(appData));
        }

        // Check if daily reset is needed
        function checkDailyReset() {
            const today = new Date().toDateString();
            if (appData.lastReset !== today) {
                resetDailyMissions();
                appData.lastReset = today;
                appData.daysActive++;
                saveToStorage();
            }
        }

        // Reset daily missions
        function resetDailyMissions() {
            appData.missions.forEach(mission => {
                mission.completed = false;
            });
        }

        // Render missions list
        function renderMissions() {
            const missionsList = document.getElementById('missionsList');
            missionsList.innerHTML = '';
            
            appData.missions.forEach(mission => {
                const missionElement = document.createElement('div');
                missionElement.className = 'flex items-center justify-between p-3 tech-border rounded-lg';
                missionElement.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border-2 ${mission.completed ? 'border-success bg-success' : 'border-gray-500'} mr-3 flex items-center justify-center">
                            ${mission.completed ? '<i class="fas fa-check text-white text-xs"></i>' : ''}
                        </div>
                        <span class="${mission.completed ? 'text-gray-400 line-through' : 'text-white'}">${mission.name}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-xs bg-accent px-2 py-1 rounded">+${mission.points}P</span>
                        <span class="text-xs bg-warning px-2 py-1 rounded">+${mission.xp}XP</span>
                        ${!mission.completed ? `
                        <button class="complete-btn ml-2 px-3 py-1 bg-success hover:bg-green-600 text-white text-sm rounded"
                                data-id="${mission.id}">
                            Concluir
                        </button>
                        ` : ''}
                    </div>
                `;
                missionsList.appendChild(missionElement);
            });

            // Add event listeners to complete buttons
            document.querySelectorAll('.complete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const missionId = parseInt(e.target.dataset.id);
                    completeMission(missionId);
                });
            });
        }

        // Render shop items
        function renderShop() {
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = '';
            
            appData.shopItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'tech-border p-4 rounded-lg';
                itemElement.innerHTML = `
                    <h3 class="font-bold text-lg mb-2">${item.name}</h3>
                    <p class="text-gray-400 text-sm mb-3">${item.description}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-accent font-bold">${item.cost} Pontos</span>
                        <button class="buy-btn px-3 py-1 bg-accent hover:bg-indigo-700 text-white text-sm rounded"
                                data-id="${item.id}">
                            Comprar
                        </button>
                    </div>
                `;
                shopItems.appendChild(itemElement);
            });

            // Add event listeners to buy buttons
            document.querySelectorAll('.buy-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const itemId = parseInt(e.target.dataset.id);
                    buyItem(itemId);
                });
            });
        }

        // Complete a mission
        function completeMission(missionId) {
            const mission = appData.missions.find(m => m.id === missionId);
            if (mission && !mission.completed) {
                mission.completed = true;
                appData.user.points += mission.points;
                appData.user.xp += mission.xp;
                appData.user.totalMissions++;
                
                // Check for level up
                checkLevelUp();
                
                saveToStorage();
                renderMissions();
                updateUI();
                
                // Special case for notes mission
                if (missionId === 10) {
                    showModal(
                        "Missão de Anotações",
                        "Você completou a missão de anotar progresso! Vá para a aba 'Anotações' para registrar suas observações.",
                        () => {
                            switchTab('notes');
                        }
                    );
                }
            }
        }

        // Buy an item from shop
        function buyItem(itemId) {
            const item = appData.shopItems.find(i => i.id === itemId);
            if (item && appData.user.points >= item.cost) {
                showModal(
                    "Confirmar Compra",
                    `Tem certeza que deseja comprar "${item.name}" por ${item.cost} pontos?`,
                    () => {
                        appData.user.points -= item.cost;
                        appData.user.itemsBought++;
                        saveToStorage();
                        updateUI();
                        
                        showModal(
                            "Compra Realizada",
                            `Você comprou "${item.name}" com sucesso!`,
                            () => {}
                        );
                    }
                );
            } else if (appData.user.points < item.cost) {
                showModal(
                    "Pontos Insuficientes",
                    `Você precisa de ${item.cost} pontos para comprar este item, mas tem apenas ${appData.user.points} pontos.`,
                    () => {}
                );
            }
        }

        // Check if user should level up
        function checkLevelUp() {
            const currentLevel = appData.user.level;
            const nextLevelXp = xpRequirements[currentLevel];
            
            if (appData.user.xp >= nextLevelXp && currentLevel < xpRequirements.length - 1) {
                appData.user.level++;
                appData.user.xp -= nextLevelXp;
                
                showModal(
                    "Parabéns!",
                    `Você subiu para o nível ${appData.user.level}! Continue com as missões para progredir ainda mais.`,
                    () => {}
                );
            }
        }

        // Update UI elements
        function updateUI() {
            // Update user stats
            document.getElementById('userLevel').textContent = appData.user.level;
            document.getElementById('userPoints').textContent = appData.user.points;
            document.getElementById('totalMissions').textContent = appData.user.totalMissions;
            document.getElementById('totalPoints').textContent = appData.user.points;
            document.getElementById('daysActive').textContent = appData.user.daysActive;
            document.getElementById('itemsBought').textContent = appData.user.itemsBought;
            
            // Update progress bars
            const completedMissions = appData.missions.filter(m => m.completed).length;
            const totalMissions = appData.missions.length;
            const progressPercentage = (completedMissions / totalMissions) * 100;
            
            document.getElementById('dailyProgress').textContent = `${Math.round(progressPercentage)}%`;
            document.getElementById('progressBar').style.width = `${progressPercentage}%`;
            
            // Update XP bar
            const currentLevel = appData.user.level;
            const currentXp = appData.user.xp;
            const levelXp = xpRequirements[currentLevel];
            const xpPercentage = (currentXp / levelXp) * 100;
            
            document.getElementById('xpBar').style.width = `${xpPercentage}%`;
            document.getElementById('xpText').textContent = `XP: ${currentXp}/${levelXp}`;
            
            // Update notes
            document.getElementById('notesTextarea').value = appData.notes;
        }

        // Show confirmation modal
        function showModal(title, message, confirmCallback) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('confirmationModal').classList.remove('hidden');
            
            document.getElementById('modalConfirm').onclick = () => {
                document.getElementById('confirmationModal').classList.add('hidden');
                confirmCallback();
            };
            
            document.getElementById('modalCancel').onclick = () => {
                document.getElementById('confirmationModal').classList.add('hidden');
            };
        }

        // Switch between tabs
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(`${tabName}Tab`).classList.remove('hidden');
            
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-accent');
                btn.classList.add('border-transparent');
            });
            
            document.querySelector(`.tab-btn[data-tab="${tabName}"]`).classList.add('border-accent');
            document.querySelector(`.tab-btn[data-tab="${tabName}"]`).classList.remove('border-transparent');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Tab navigation
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const tabName = e.target.dataset.tab;
                switchTab(tabName);
            });
        });
        
        // Save notes
        document.getElementById('saveNotes').addEventListener('click', () => {
            appData.notes = document.getElementById('notesTextarea').value;
            saveToStorage();
            
            // If notes mission is not completed, complete it
            const notesMission = appData.missions.find(m => m.id === 10);
            if (notesMission && !notesMission.completed && appData.notes.trim().length > 0) {
                completeMission(10);
            }
            
            showModal("Sucesso", "Suas anotações foram salvas com sucesso!", () => {});
        });
    </script>
</body>
</html>